{"createdAt":"2025-07-02T09:15:45.322Z","updatedAt":"2025-07-14T04:10:39.988Z","id":"iDvhyI2pFQ4DRjY7","name":"YoutubeData Again","active":false,"isArchived":false,"nodes":[{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[0,100],"id":"12c7ad19-8eea-48c1-b413-4d6b3c18c1c7","name":"When clicking ‘Execute workflow’"},{"parameters":{"assignments":{"assignments":[{"id":"124b16a2-feb6-441c-9d3d-eb7710e3f167","name":"youtubechanneladdress","value":"https://www.youtube.com/@kamarfilm4215","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[220,100],"id":"69854f5e-bffa-442d-870b-99b6cde33083","name":"Edit Fields"},{"parameters":{"jsCode":"const hashtag = items[0].json.hashtag || '';\nconst videos = items[0].json.items || [];\nconst channels = items[1] && items[1].json.items ? items[1].json.items : [];\n\nconst channelMap = {};\nchannels.forEach(c => {\n  channelMap[c.id] = {\n    channelTitle: c.snippet.title,\n    subscriberCount: parseInt(c.statistics.subscriberCount)\n  }\n});\n\nconst now = new Date();\nconst result = videos.map((v, idx) => {\n  const channelId = v.snippet.channelId;\n  const viewCount = parseInt(v.statistics.viewCount);\n  const likeCount = parseInt(v.statistics.likeCount || 0);\n  const commentCount = parseInt(v.statistics.commentCount || 0);\n  const title = v.snippet.title || '';\n  const desc = v.snippet.description || '';\n  const publishedAt = new Date(v.snippet.publishedAt);\n  const channel = channelMap[channelId] || {};\n  const subscriberCount = channel.subscriberCount || 1;\n  // Analisa\n  const daysAgo = Math.floor((now - publishedAt)/(1000*60*60*24));\n  const viralWords = /viral|trending|kisah nyata|2025/i.test(title + ' ' + desc);\n  const allCaps = title === title.toUpperCase() && title.length > 10;\n  const ratioViewSub = (viewCount/subscriberCount).toFixed(2);\n  const ratioLikeView = likeCount && viewCount ? (likeCount/viewCount).toFixed(2) : null;\n  const isNew = daysAgo < 7;\n  return {\n    No: idx + 1, // <---- INI nomor urut\n    hashtag,\n    title,\n    videoUrl: `https://youtube.com/watch?v=${v.id}`,\n    channelTitle: channel.channelTitle || '',\n    viewCount,\n    subscriberCount,\n    daysAgo,\n    isNew,\n    viralWords,\n    allCaps,\n    ratioViewSub,\n    ratioLikeView,\n    likeCount,\n    commentCount,\n    publishedAt: v.snippet.publishedAt\n  }\n}).filter(r => r.viewCount && r.subscriberCount);\n\nreturn result.map(r => ({json: r}));\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1320,100],"id":"ffa467bb-9036-4189-8090-619cf87b8d93","name":"Code"},{"parameters":{"url":"https://www.googleapis.com/youtube/v3/search","authentication":"predefinedCredentialType","nodeCredentialType":"youTubeOAuth2Api","sendQuery":true,"queryParameters":{"parameters":[{"name":"part","value":"snippet"},{"name":"maxResults","value":"10"},{"name":"channelId","value":"={{ $json.parsedHashtagArr }}"},{"name":"type","value":"video"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[440,100],"id":"4c78e2ba-1aa5-4731-9f3d-7d8f8b3397b6","name":"Cari Video YouTube Berdasarkan Hashtag","credentials":{"youTubeOAuth2Api":{"id":"SGrbwP3z3weKq6LO","name":"YouTube account"}}},{"parameters":{"url":"https://www.googleapis.com/youtube/v3/videos","authentication":"predefinedCredentialType","nodeCredentialType":"youTubeOAuth2Api","sendQuery":true,"queryParameters":{"parameters":[{"name":"part","value":"snippet,statistics"},{"name":"id","value":"={{$json.items.map(item => item.id.videoId).join(',')}}"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[660,0],"id":"85b882c5-f07e-4795-87c6-38a0ab3ce99f","name":"Ambil Statistik Video","credentials":{"youTubeOAuth2Api":{"id":"SGrbwP3z3weKq6LO","name":"YouTube account"}}},{"parameters":{"url":"https://www.googleapis.com/youtube/v3/channels","authentication":"predefinedCredentialType","nodeCredentialType":"youTubeOAuth2Api","sendQuery":true,"queryParameters":{"parameters":[{"name":"part","value":"snippet,statistics"},{"name":"id","value":"={{$json.items.map(item => item.snippet.channelId).join(',')}}"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[880,200],"id":"d4b11a88-28c3-4ec9-9996-becde74d5706","name":"Ambil Statistik Channel","credentials":{"youTubeOAuth2Api":{"id":"SGrbwP3z3weKq6LO","name":"YouTube account"}}},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[1100,100],"id":"79c9f2c0-6423-4233-9318-8623e466f540","name":"Merge"},{"parameters":{"assignments":{"assignments":[{"id":"e27fb1b3-ec3f-4842-a8b2-07574d92845c","name":"hashtag","value":"={{ $('Edit Fields2').item.json.parsedHashtagArr }}","type":"string"}]},"includeOtherFields":true,"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[880,0],"id":"097f167c-7b17-4fc8-948f-1756f1b9adfe","name":"Edit Fields3"},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"1As4bE1rLoxxWfW-tQ7LkYrvSue9fx9bH-uYaA9d9W0U","mode":"list","cachedResultName":"analisisvideo","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1As4bE1rLoxxWfW-tQ7LkYrvSue9fx9bH-uYaA9d9W0U/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Sheet1","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1As4bE1rLoxxWfW-tQ7LkYrvSue9fx9bH-uYaA9d9W0U/edit#gid=0"},"columns":{"mappingMode":"autoMapInputData","value":{"No":"={{ $json.No }}","hashtag":"={{ $json.hashtag }}"},"matchingColumns":[],"schema":[{"id":"No","displayName":"No","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"hashtag","displayName":"hashtag","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"title","displayName":"title","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"videoUrl","displayName":"videoUrl","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"channelTitle","displayName":"channelTitle","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"viewCount","displayName":"viewCount","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"subscriberCount","displayName":"subscriberCount","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"daysAgo","displayName":"daysAgo","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"isNew","displayName":"isNew","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"viralWords","displayName":"viralWords","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"allCaps","displayName":"allCaps","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"ratioViewSub","displayName":"ratioViewSub","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"ratioLikeView","displayName":"ratioLikeView","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"likeCount","displayName":"likeCount","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"commentCount","displayName":"commentCount","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"publishedAt","displayName":"publishedAt","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.6,"position":[1540,0],"id":"190ad61f-ef1f-40bb-9902-7473166a99fd","name":"Append row in sheet","credentials":{"googleSheetsOAuth2Api":{"id":"EvJFGzn1Pb9TRY0E","name":"Google Sheets account Tropicans"}}},{"parameters":{"workflowId":{"__rl":true,"value":"4UeNPDLPM0fQgPgj","mode":"list","cachedResultName":"YTAnalyticsBYHashtags1"},"workflowInputs":{"mappingMode":"defineBelow","value":{},"matchingColumns":[],"schema":[],"attemptToConvertTypes":false,"convertFieldsToString":true},"options":{}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.2,"position":[1540,200],"id":"d4300707-16bc-4e2d-9a5a-c88543ac3c18","name":"Execute Workflow"}],"connections":{"Edit Fields":{"main":[[{"node":"Cari Video YouTube Berdasarkan Hashtag","type":"main","index":0}]]},"Code":{"main":[[{"node":"Append row in sheet","type":"main","index":0},{"node":"Execute Workflow","type":"main","index":0}]]},"Cari Video YouTube Berdasarkan Hashtag":{"main":[[{"node":"Ambil Statistik Video","type":"main","index":0},{"node":"Ambil Statistik Channel","type":"main","index":0}]]},"Ambil Statistik Video":{"main":[[{"node":"Edit Fields3","type":"main","index":0}]]},"Ambil Statistik Channel":{"main":[[{"node":"Merge","type":"main","index":1}]]},"Merge":{"main":[[{"node":"Code","type":"main","index":0}]]},"Edit Fields3":{"main":[[{"node":"Merge","type":"main","index":0}]]},"When clicking ‘Execute workflow’":{"main":[[{"node":"Edit Fields","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"2ce539da-583d-4d72-9091-17e2c816da98","triggerCount":0,"tags":[]}